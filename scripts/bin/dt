#!/bin/bash

# This script manages some commonly run (for me) dtach sessions). It changes
# the detach command to C-S-t (hence the tput smkx; tput rmkx sandwich), and
# either launches or attaches to:
#   (a) rtorrent+PyroScope
#   (b) irssi
#   (c) dzen statusbar

if [[ $# -ne 1 ]]
then
  echo "No arguments supplied."
  exit 1
else
  if [[ "$1" = "rt" ]]
  then
    tmp_path="/tmp/rtorrent"
    bin_path="/home/voighta/rtorrent/start"
  fi
  if [[ "$1" = "irc" ]]
  then
    tmp_path="/tmp/irssi"
    bin_path="/usr/bin/irssi"
  fi
  if [[ "$1" = "dzen" ]]
  then
    tput smkx
    dtach -n /tmp/dzen -e "^T" /home/voighta/bin/dzen_bar.sh
    tput rmkx
    exit 0
  fi
  if [[ -z "$tmp_path" ]]
  then
    echo "Incorrect argument supplied."
    exit 1
  fi

  tput smkx
  if [[ -e "$tmp_path" ]]
  then
    dtach -a "$tmp_path" -e "^T"
  else
    dtach -c "$tmp_path" -e "^T" "$bin_path"
  fi
  tput rmkx
fi
